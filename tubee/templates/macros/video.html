{% macro table() -%}
<table
  class="table table-striped table-hover align-middle datatable"
  data-datatable-searching="false"
  data-datatable-order='[[3, "asc"]]'
  data-datatable-disable-order="[0, 4]"
  data-datatable-callback="updateBtnAllChecked"
  data-datatable-ajax="api_video.unchecked"
>
  <thead class="table-dark">
    <tr>
      <th scope="col"></th>
      <th scope="col">Channel</th>
      <th scope="col">Title</th>
      <th scope="col">Published</th>
      <th scope="col">Actions</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>
{%- endmacro %}

<!-- prettier-ignore -->
{% macro table_thumbnails(row) -%}
<a href="https://youtu.be/{{ row.Video.id }}" target="_blank">
  <picture>
    <source
      media="(max-width: 1199px)"
      srcset="{{ row.Video.details.thumbnails.default.url }}"
    />
    <source
      media="(min-width: 1200px)"
      srcset="{{ row.Video.details.thumbnails.medium.url }}"
    />
    <img src="{{ row.Video.details.thumbnails.medium.url }}" class="rounded" />
  </picture>
</a>
{%- endmacro %}

<!-- prettier-ignore -->
{% macro table_channel(row) -%}
<a
  href="https://www.youtube.com/channel/{{ row.Video.channel_id }}"
  target="_blank"
>
  {{ row.Video.channel.name }}
</a>
{%- endmacro %}

<!-- prettier-ignore -->
{% macro table_title(row) -%}
<a href="https://youtu.be/{{ row.Video.id }}" target="_blank">
  {{ row.Video.name | safe }}
</a>
<a
  href="#"
  class="text-muted clipboard"
  data-clipboard-text="{{ row.Video.id }}"
>
  <p>#{{ row.Video.id }}</p>
</a>
{%- endmacro %}

<!-- prettier-ignore -->
{% macro table_published(row) -%}
<p
  class="moment"
  data-moment-timestamp="{{ row.Video.uploaded_timestamp.timestamp() }}"
  data-moment-format="lll"
></p>
{%- endmacro %}

<!-- prettier-ignore -->
{% macro table_actions(row) -%}
<div class="btn-group" role="group" aria-label="Video Actions">
  {% for action in row.Subscription.actions %}
  <button
    type="button"
    class="btn btn-primary"
    onclick="$(this).buttonAPI()"
    data-api="api_video.execute_action"
    data-api-method="GET"
    data-path-params="{{ dict(video_id=row.Video.id, action_id=action.id) | tojson | forceescape }}"
  >
    {{ action.name }}
  </button>
  {% endfor %}
</div>
{%- endmacro %}

<!-- prettier-ignore -->
{% macro check_button(video_ids) -%}
<button
  class="btn btn-success btn-all-checked mb-2"
  onclick="$(this).buttonAPI()"
  data-api="api_video.mark_as_checked"
  data-api-method="GET"
  data-query-params="{{ dict(video_ids=video_ids | join(',')) | tojson | forceescape }}"
>
  Mark all as Checked
</button>
{%- endmacro %}
